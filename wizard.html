<!DOCTYPE html>
<!--[if IEMobile 7]><html class="iem7 no-js" lang="en" dir="ltr"><![endif]-->
<!--[if lt IE 7]><html class="lt-ie9 lt-ie8 lt-ie7 no-js" lang="en" dir="ltr"><![endif]-->
<!--[if (IE 7)&(!IEMobile)]><html class="lt-ie9 lt-ie8 no-js" lang="en" dir="ltr"><![endif]-->
<!--[if IE 8]><html class="lt-ie9 no-js" lang="en" dir="ltr"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)]><!--> <html class="no-js not-oldie" lang="en" dir="ltr"> <!--<![endif]-->
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="true" />
  <link rel="shortcut icon" href="https://www.epa.gov/sites/all/themes/epa/favicon.ico" type="image/vnd.microsoft.icon" />
  <meta name="MobileOptimized" content="width" />
  <meta http-equiv="cleartype" content="on" />
  <meta http-equiv="ImageToolbar" content="false" />
  <meta name="viewport" content="width=device-width" />
  <meta name="version" content="20161218" />
<!--googleon: all-->
  <meta name="DC.description" content="" />
  <meta name="DC.title" content="" />
  <title>Tool Finder</title>
<!--googleoff: snippet-->
  <meta name="keywords" content="" />
  <link rel="shortlink" href="" />
  <link rel="canonical" href="" />
  <meta name="DC.creator" content="" />
  <meta name="DC.language" content="en" />
  <meta name="DC.Subject.epachannel" content="" />
  <meta name="DC.type" content="" />
  <meta name="DC.date.created" content="" />
  <meta name="DC.date.modified" content="" />
<!--googleoff: all-->
  <link type="text/css" rel="stylesheet" href="https://www.epa.gov/sites/all/libraries/template2/s.css" media="all" />
  <!--[if lt IE 9]><link type="text/css" rel="stylesheet" href="https://www.epa.gov/sites/all/themes/epa/css/ie.css" media="all" /><![endif]-->
  
  <link rel="stylesheet" href="https://www.epa.gov/sites/all/libraries/js/datatables-1.10.12/datatables.min.css">
  <link rel="stylesheet" href="https://www.epa.gov/sites/all/libraries/js/datatables-1.10.12/Select/css/select.dataTables.min.css">
  <link rel="stylesheet" href="https://www.epa.gov/sites/all/libraries/js/datatables-1.10.12/Responsive/css/responsive.dataTables.min.css">
  <link rel="stylesheet" href="https://www.epa.gov/sites/all/libraries/js/datatables-1.10.12/Buttons/css/buttons.dataTables.min.css">
  <link type="text/css" rel="stylesheet" href="css/base.css" media="all" />
  <link rel="alternate" type="application/atom+xml" title="EPA.gov All Press Releases" href="https://www.epa.gov/newsreleases/search/rss" />
  <link rel="alternate" type="application/atom+xml" title="EPA.gov Headquarters Press Releases" href="https://www.epa.gov/newsreleases/search/rss/field_press_office/headquarters" />
  <link rel="alternate" type="application/atom+xml" title="Greenversations, EPA's Blog" href="https://blog.epa.gov/blog/feed/" />
  <!--[if lt IE 9]><script src="https://www.epa.gov/sites/all/themes/epa/js/html5.js"></script><![endif]-->
  <style>
    @media screen and (min-width: 45em), print and (min-width: 45em) {
      .row > .size-95of100.col {
        width: 95%;
      }
    }
    @media screen and (max-width: 480px) {
      .navbar {
        overflow: hidden;
        background: rgb(50, 58, 69);
        background: rgba(50, 58, 69, 0.75);
        /*background-color: #323a45;*/
        position: fixed;
        bottom: 0;
        left: 0px;
        width: 100%;
      }
      .navbar button {
        margin: .2em 0 .2em 0;
      }
      .navbar div {
        margin: .2em 0 .2em 0;
        border-radius: 0; 
      }
    }
    label{
      border-radius: .5em;
    }
    .success {
      border: .5em solid #e7f4e4;
      border-radius: .5em;
      background-color: #e7f4e4;
      margin-bottom: 1.5em;
    }
    .warning {
      border: .5em solid #fff1d2;
      border-radius: .5em;
      background-color: #fff1d2;
      color: #000;
      margin-bottom: 1.5em;
    }
    #results-container {
      border: 2px solid #d6d7d9;
      margin: 1em 0 0 0;
      padding: .5em;
    }
    .expand:hover {
      background-color: #e7f4e4;
      cursor: pointer;
    }
    .expand {
      margin: 0;
    }
    .list-div {
      background-color: #f1f1f1;
      margin-top: .5em;
      border-radius: 5px;
      padding: 2px;
    }
    [role=tab] {
      margin: 1px 0 0;
      border-bottom-left-radius:0;
      border-bottom-right-radius:0;
    }
    [role=tabpanel] {
      padding: .5em;
      border: 2px solid #d6d7d9;
      border-radius: 5px;
      border-top-left-radius:0;
      border-top-right-radius:0;
    }
    [aria-hidden="true"] {
      display: none;
    }
    .results-label {
      display: inline;
      background-color:transparent;
    }
    .tool-label:focus + label {
      background-color:#e1f3f8;
    }
    .tool-label:checked + label {
      background-color:#d6d7d9;
    }
    .unselectable { /* Makes text in an element unselectable */
      -webkit-user-select: none;
      -moz-user-select: none;
      -ms-user-select: none;
      -o-user-select: none;
      user-select: none;
    }
    button:disabled {
      background-color:#aeb0b5
    }
    * {
      -ms-transition: none;
      transition: none;
    }
    .accordian-result {
      background-image: url(https://www.epa.gov/sites/all/themes/epa/img/arrow-alt-down.png);
      background-repeat: no-repeat;
      float: right;
      height: 13px;
      margin: 5px;
      width: 13px;
    }
    .collapsible {
      transform: rotateX(180deg);
    }
    .tabs, .tabs > li {
      margin-bottom: 0;
      border: none;
    }
    hr {
      border: .5em solid #d6d7d9;
      border-radius: 1em;
      height: 0;
    }
    .bold {
      font-weight: bold;
    }
    #results-notification {
      width: 100%;
      padding-top: .2em;
      height: 2em;
      border: .4em;
    }
    .icon-button, .icon-button:hover, .icon-button:focus {
      background: transparent;
      border: none;
      width: auto;
    }
    .icon-img {
      width: 2em;
    }
    .navbar {
      display: inline;
    }
    #tabsnav {
      list-style: none;
    }
    #tabsnav li {
      padding-left: 0; /* override s.css */
      padding-right: 0; /* override s.css */
    }
    #tabsnav li a {
      background: #205493;
      border-radius: 0 !important; /* override s.css */
      color: #fff;
      float: left;
      font-size: 17px;
      font-weight: bold;
      height: 40px;
      line-height: 40px;
      margin: 0 5px 0 0;
      padding: 0px 16px 0 35px;
      position: relative;
      text-align: center;
      text-decoration: none;
    }
    #tabsnav li a:after {
      border-top: 20px solid transparent;
      border-bottom: 20px solid transparent;
      border-left: 20px solid #205493;
      content: "";
      position: absolute;
      right: -20px;
      top: 0;
      z-index: 1;
    }
    #tabsnav li a:before {
      border-top: 20px solid transparent;
      border-bottom: 20px solid transparent;
      border-left: 20px solid #fff;
      content: "";
      left: 0;
      position: absolute;
      top: 0;
    }
    #tabsnav li:first-child a {
      border-top-left-radius: 3px !important;
      border-bottom-left-radius: 3px !important;
      padding-left: 15px;
    }
    #tabsnav li:first-child a:before {
      display: none;
    }
    #tabsnav li:last-child a {
      border-top-right-radius: 3px !important;
      border-bottom-right-radius: 3px !important;
      padding-right: 15px;
    }
    #tabsnav li:last-child a:after {
      display: none;
    }
    #tabsnav li a:hover, #tabsnav li a.active {
      background: #00a6d2;
      color: #000;
    }
    #tabsnav li a:hover:after, #tabsnav li a.active:after {
      border-left-color: #00a6d2;
    }
    @media (max-width: 1000px) {
      #tabsnav {
        display: block;
      }
      #tabsnav li {
        width: 100%;
      }
      #tabsnav li a {
        float: none;
        padding: 0;
        margin: 0 0 5px 0; 
      }
      #tabsnav li a:before, #tabsnav li a:after {
        border-top: 0;
        border-bottom: 0;
        border-left: 0;
      }
      #tabsnav li:first-child a {
        border-radius: 0;
        border-top-left-radius: 3px;
        border-top-right-radius: 3px;
        padding-left: 0;
      }
      #tabsnav li:last-child a {
        border-radius: 0;
        border-bottom-left-radius: 3px;
        border-bottom-right-radius: 3px;
        padding-right: 0;
      }
    }
  </style>
</head>
<!-- NOTE, figure out body classes! -->
<body class="node-type-page microsite" >
  <!-- Google Tag Manager -->
  <!--DEV: REMOVED FOR DEVELOPMENT; REPLACE FOR PRODUCTION
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-L8ZB" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-L8ZB');</script>
  -->
  <!-- End Google Tag Manager -->
  <div class="skip-links"><a href="#main-content" class="skip-link element-invisible element-focusable">Jump to main content</a></div>
  <header class="masthead clearfix" role="banner">
    <img class="site-logo" src="https://www.epa.gov/sites/all/themes/epa/logo.png" alt="" />
    <hgroup class="site-name-and-slogan">
      <h1 class="site-name"><a href="https://www.epa.gov/" title="Go to the home page" rel="home"><span>US EPA</span></a></h1>
      <div class="site-slogan">United States Environmental Protection Agency</div>
    </hgroup>
    <form class="epa-search" method="get" action="https://search.epa.gov/epasearch/epasearch">
      <label class="element-hidden" for="search-box">Search</label>
      <input class="form-text" placeholder="Search EPA.gov" name="querytext" id="search-box" value="" />
      <button class="epa-search-button" id="search-button" type="submit" title="Search">Search</button>
      <input type="hidden" name="areaname" value="" />
      <input type="hidden" name="areacontacts" value="" />
      <input type="hidden" name="areasearchurl" value="" />
      <input type="hidden" name="typeofsearch" value="epa" />
      <input type="hidden" name="result_template" value="2col.ftl" />
    </form>
  </header>
  <section id="main-content" class="main-content clearfix" role="main">
    <div class="region-preface clearfix">
      <div id="block-pane-epa-web-area-connect" class="block block-pane contextual-links-region">
        <ul class="menu utility-menu">
          <li class="menu-item"><a href="#feedback-modal" class="menu-link contact-us" id="feedback-link">Contact Us</a></li>
        </ul>
      </div>
    </div>
    <div class="main-column clearfix">
    <!--googleon: all-->
      <h1 class="page-title">Tool Finder</h1>
      <div class="panel-pane pane-node-content" >
        <div class="pane-content">
          <div class="node node-page clearfix view-mode-full">
            <h2 id="page-description-title" class="title">Description</h2>
            <p>Tool Finder is a wizard that helps users find relevant tools from an inventory of tools designed to support sustainable and healthy communities.</p>
            <h3>Using Tool Finder:</h3>
            <ul>
              <li>choose applicable roles in the community (e.g. Developer),</li>
              <li>choose from a list of objectives of interest (e.g. “Maximize health and safety”), and</li>
              <li>output a list of tools selected by relevant concepts (e.g. “Health & Safety”).</li>
            </ul>
            <p>Users can expand and narrow their search at each stage in the wizard by selecting greater or fewer roles, objectives, or concepts.</p>
            <h4 id="disclaimer-title">Disclaimer</h4>
            <p id="disclaimer-text">The tools listed below are for informational purposes only. The EPA and its employees do not endorse any product, services, or organizations listed.</p>
            <div aria-live="polite" id="toast"></div>
            <div id="tabs">
              <ul class="tabs" id="tabsnav" role="tablist">
                <li><a aria-controls="role-panel" aria-selected="true" class="menu-internal active" href="#role-tab" id="role-tab" role="tab">Role</a></li>
                <li aria-hidden="true"><a aria-controls="subrole-panel" aria-disabled="true" aria-hidden="true" aria-selected="false" class="menu-internal" data-name="Role" data-href="#subrole-tab" id="subrole-tab" role="tab">Subrole</a></li>
                <li aria-hidden="true"><a aria-controls="fundamental-objective-panel" aria-disabled="true" aria-hidden="true" aria-selected="false" class="menu-internal" data-name="Subrole" data-href="#fundamental-objective-tab" id="fundamental-objective-tab" role="tab">Fundamental Objective</a></li>
                <li aria-hidden="true"><a aria-controls="objective-panel" aria-disabled="true" aria-hidden="true" aria-selected="false" class="menu-internal" data-name="Fundamental Objective" data-href="#objective-tab" id="objective-tab" role="tab">Objective</a></li>
                <li aria-hidden="true"><a aria-controls="concept-panel" aria-disabled="true" aria-hidden="true" aria-selected="false" class="menu-internal" data-name="Objective" data-href="#concept-tab" id="concept-tab" role="tab">Concept</a></li>
                <li aria-hidden="true"><a aria-controls="results-panel" aria-selected="false" class="menu-internal" href="#results-tab" id="results-tab" role="tab">Results</a></li>
                <li aria-hidden="true"><a aria-controls="selected-tool-panel" aria-selected="false" class="menu-internal" href="#selected-tool-tab" id="selected-tool-tab" role="tab">Selected Tool</a></li>
              </ul>
              <div aria-labelledby="role-tab" id="role-panel" role="tabpanel" aria-hidden="false">
                <h4>Roles <small>Who are you?<button class="icon-button" onclick="$('#role-help').toggle()"><img class="icon-img" src="https://www.epa.gov/sites/all/themes/epa/img/svg/info.svg"/></button></small></h4>
                <p>Select one or more roles and proceed to the subrole tab or select Next.
                  <p aria-hidden="true" class="success" id="role-help">
                    <img src="https://www.epa.gov/sites/all/themes/epa/img/svg/info.svg" style="width: 2em;"/>
                    <em>Need help?</em> Select the <strong>role</strong>(s) (e.g. Developer) that broadly describes your occupation or position in order to begin narrowing your search for tools that address issues relevant to your role. Expand your search for tools by selecting additional roles.
                  </p>
                </p>
                <div class="navbar">
                  <button class="enabled-by-subrole persist" onclick="activateNextTab($('#subrole-tab'), 'wizard.html#subrole-tab')">Next</button>
                </div>
                <hr />
                <button class="button-grey" onclick="selectAll('role', roleSelect)">Select All Roles</button>
                <button class="button-grey" onclick="deselectAll('role', roleSelect)">Deselect All Roles</button>
                <div id="role"></div>
                <p class="pagetop"><a href="#tabs">Return to top of section</a></p>
              </div>
              <div aria-labelledby="subrole-tab" id="subrole-panel" role="tabpanel" aria-hidden="true">
                <h4>Subroles <small>What do you do?<button class="icon-button" onclick="$('#subrole-help').toggle()"><img class="icon-img" src="https://www.epa.gov/sites/all/themes/epa/img/svg/info.svg"/></button></small></h4>
                <p>Select one or more subroles and proceed to the fundamental objective tab or select Next.
                  <p aria-hidden="true" class="success" id="subrole-help">
                    <img class="icon-img" src="https://www.epa.gov/sites/all/themes/epa/img/svg/info.svg"/>
                      <em>Need help?</em> Under your broad role(s), indicate the <strong>subrole</strong>(s) (e.g. Real Estate Developer) that most accurately describes the specific type of work you do in order to continue narrowing your search for tools that address issues relevant to your role. Expand your search for tools by selecting additional subroles.
                  </p>
                </p>
                <div class="navbar">
                  <button class="enabled-by-fundamental-objective persist" onclick="activateNextTab($('#fundamental-objective-tab'), 'wizard.html#fundamental-objective-tab')">Next</button>
                </div>
                <hr />
                <button class="button-grey" onclick="selectAll('subrole', subroleSelect)">Select All Subroles</button>
                <button class="button-grey" onclick="deselectAll('subrole', subroleSelect)">Deselect All Subroles</button>
                <div id="subrole"></div>
                <p class="pagetop"><a href="#tabs">Return to top of section</a></p>
              </div>
              <div aria-labelledby="fundamental-objective-tab" id="fundamental-objective-panel" role="tabpanel" aria-hidden="true">
                <h4>Fundamental Objectives <small>What do you want to accomplish?<button class="icon-button" onclick="$('#fundamental-objective-help').toggle()"><img class="icon-img" src="https://www.epa.gov/sites/all/themes/epa/img/svg/info.svg"/></button></small></h4>
                <p>Select one or more fundamental objectives and proceed to the objective tab or select Next.
                  <p aria-hidden="true" class="success" id="fundamental-objective-help">
                    <img class="icon-img" src="https://www.epa.gov/sites/all/themes/epa/img/svg/info.svg"/>
                      <em>Need help?</em> Ask yourself: “What general goals do I want to accomplish?” <strong>fundamental objectives</strong> (e.g. “Maximize health and safety”) describe general goals. Your selection(s) will refine your search for targeted tools that can help you meet your objective(s). Expand your search for tools by selecting additional objectives.
                  </p>
                </p>
                <div class="navbar">
                  <button class="enabled-by-objective persist" onclick="activateNextTab($('#objective-tab'), 'wizard.html#objective-tab')">Next</button>
                </div>
                <hr />
                <button class="button-grey" onclick="selectAll('fundamental-objective', fundamentalObjectiveSelect)">Select All Fundamental Objectives</button>
                <button class="button-grey" onclick="deselectAll('fundamental-objective', fundamentalObjectiveSelect)">Deselect All Fundamental Objectives</button>
                <div id="fundamental-objective"></div>
                <p class="pagetop"><a href="#tabs">Return to top of section</a></p>
              </div>
              <div aria-labelledby="objective-tab" id="objective-panel" role="tabpanel" aria-hidden="true">
                <h4>Objectives <small>How do you want to accomplish it?<button class="icon-button" onclick="$('#objective-help').toggle()"><img class="icon-img" src="https://www.epa.gov/sites/all/themes/epa/img/svg/info.svg"/></button></small></h4>
                <p>Select one or more objectives and proceed to the concept tab or select Next.
                  <p aria-hidden="true" class="success" id="objective-help">
                    <img class="icon-img" src="https://www.epa.gov/sites/all/themes/epa/img/svg/info.svg"/>
                      <em>Need help?</em> Ask yourself: “What specific goals can I set to accomplish my general objectives?” Select the <strong>objective</strong>(s) (e.g. “Maximize safety of buildings”) that best describe your explicit goals. Your selection(s) will refine your search for targeted tools that can help you meet your objective(s). Expand your search for tools by selecting additional objectives.
                  </p>
                </p>
                <div class="navbar">
                  <button class="enabled-by-concept persist" onclick="activateNextTab($('#concept-tab'), 'wizard.html#concept-tab');updateConcepts()">Next</button>
                </div>
                <hr />
                <input id="objective-relevance" type="hidden" value="1" />
                <button class="button-grey" onclick="selectAll('objective', objectiveSelect)">Select All Objectives</button>
                <button class="button-grey" onclick="deselectAll('objective', objectiveSelect)">Deselect All Objectives</button>
                <div class="right">
                  <button class="button-white" onclick="objectiveDisplay(-1)" id="objective-relevance-decrease">Show Fewer Objectives</button>
                  <button class="button-white" onclick="objectiveDisplay(1)" id="objective-relevance-increase">Show More Objectives</button>
                </div>
                <div id="objective"></div>
                <p class="pagetop"><a href="#tabs">Return to top of section</a></p>
              </div>
              <div aria-labelledby="concept-tab" id="concept-panel" role="tabpanel" aria-hidden="true">
                <h4>Concepts <small>Where do you want to direct your focus? <button class="icon-button" onclick="$('#concept-help').toggle()"><img class="icon-img" src="https://www.epa.gov/sites/all/themes/epa/img/svg/info.svg"/></button></small></h4>
                <p>Select one or more concepts. Each concept is labeled with the number of tools it will add or remove from your results. If you have selected one or more concepts and you would like to expand your selection to include additional related concepts, click <strong>Add Additional Concepts</strong>.</p>
                <p>Use the <strong>Show Results</strong> button to display your list of targeted tools.</p>
                <p aria-hidden="true" class="success" id="concept-help">
                  <img class="icon-img" src="https://www.epa.gov/sites/all/themes/epa/img/svg/info.svg"/>
                    <em>Need help?</em> <strong>concepts</strong> (e.g. “Health & Safety”) are distinct focal areas that you and other decision makers can address with directed tools. Ask yourself: “In what focal areas do I identify a need for a tool or resource?” Select the concept(s) that most specifically describes the focal area where a tool will be helpful to you. Expand your search for tools by selecting additional concepts.
                </p>
                <div class="navbar">
                  <button class="button-aqua" id="concept-search-button" onclick="displayResults()">Show Results</button>
                  <div aria-hidden="true" id="results-notification"></div>
                </div>
                <hr class="park-mark" />
                <button class="button-grey" onclick="selectAll('concept');updateConceptsandResults()">Select All Concepts</button>
                <button class="button-grey" onclick="deselectAll('concept');updateConceptsandResults()">Deselect All Concepts</button>
                <button class="button-white right" id="expand-concepts" onclick="broadenConcepts()">Add Additional Concepts</button>
                <div id="concept"></div>
                <p class="pagetop"><a href="#tabs">Return to top of section</a></p>
              </div>
              <div aria-labelledby="results-tab" id="results-panel" role="tabpanel" aria-hidden="true">
                <h3 id="tools">Tools</h3>
                <p>Select one or more tools and they will persist as you run additional searches. Any unselected tools will be removed. You can export your selected tools to a CSV file by using the <strong>Export</strong> button.</p>
                <span>Choose a display:</span>
                  <input id="list-radio" type="radio" name="display-type" value="text" checked><label for="list-radio">Text: recommended for those on smaller screens.</label>
                  <input id="table-radio" type="radio" name="display-type" value="table"><label for="table-radio">Table: allows filtering and column sorting.</label>
                <div id="results-list-div">  
                  <button class="button-grey" onclick="selectAllToolsButton('results')">Select All Tools</button>
                  <button class="button-grey" onclick="deselectAllToolsButton('results')">Deselect All Tools</button>
                  <div class="navbar">
                    <button class="button-white right" onclick="exportCSV('results-list')">Export Selected Tools to CSV</button>
                  </div>
                  <hr />
                  <img aria-hidden="true" id="loader" src="img/loader.gif">
                  <div id="results-list" class="list"></div>
                </div>
                <div aria-hidden="true" id="results-table-div">
                  <table class="revision-table" id="results-table" width="100%">
                    <thead>
                      <tr>
                        <th></th>
                        <th></th>
                        <th>Title</th>
                        <th>Description</th>
                        <th>Operating Environment</th>
                        <th>Spatial Extent</th>
                        <th>Decision Sector</th>
                        <th>Base Cost</th>
                      </tr>
                    </thead>
                    <tbody id="results-table-body"></tbody>
                  </table>
                </div>
                <p class="pagetop"><a href="#tabs">Return to top of section</a></p>
              </div>
              <div aria-labelledby="selected-tool-tab" id="selected-tool-panel" role="tabpanel" aria-hidden="true">
                <div id="selected-tool"></div>
              </div>
              <div id="feedback-modal" class="modal">
                <div class="modal-content">
                  <div class="modal-header">
                    <span class="close" role="button" tabindex="1">&times;</span>
                    <h2>Feedback Form</h2>
                  </div>
                  <div class="modal-body">
                    <form onsubmit="toast({html: 'Feedback submission is currently unavailable.', close: true});return false;">
                      <br />
                      <div class="row">
                        <div class="col"><p>Your feedback can help us improve this application. If you have general feedback, a bug to report, an idea or tool suggestion to add to our inventory please let us know!</p></div>
                      </div>
                      <div class="row cols-3">
                        <div class="col">
                          <input checked id="general-feedback" name="feedback-type" type="Radio"/>
                          <label for="general-feedback">General feedback</label>
                        </div>
                        <div class="col">
                          <input id="report-a-bug" name="feedback-type" type="Radio"/>
                          <label for="report-a-bug">Report a bug</label>
                        </div>
                        <div class="col">  
                          <input id="suggest-an-idea" name="feedback-type" type="Radio"/>
                          <label for="suggest-an-idea">Suggest an idea or tool</label>
                        </div>
                      </div>
                      <br />
                      <div class="row">
                        <div class="col size-1of1">
                          <label for="feedback-text">Feedback</label>
                          <textarea id="feedback-text" placeholder="Enter feedback" rows="5"></textarea>
                        </div>
                      </div>
                      <div class="row cols-3">
                        <div class="col">
                          <label for="first-name">First Name (Optional)</label>
                          <input class="full-width" id="first-name" placeholder="Enter first name" type="text" />
                        </div>
                        <div class="col">
                          <label for="last-name">Last Name (Optional)</label>
                          <input class="full-width" id="last-name" placeholder="Enter last name" type="text"/>
                        </div>
                        <div class="col">
                          <label for="email">Email Address (Optional)</label>
                          <input class="full-width" id="email" placeholder="Enter email address" type="email"/>
                        </div>
                      </div>
                      <br />
                      <div class="row">
                        <div class="col">
                          <input id="submit-feedback" type="submit" value="Submit Feedback"/>
                        </div>
                      </div>
                    </form>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div id="block-epa-og-footer" class="block block-epa-og"></div>
<!--googleoff: all-->
    </div>
  </section>
<nav class="nav simple-nav simple-main-nav" role="navigation">
  <div class="nav__inner">
    <h2 class="element-invisible">Main menu</h2>
    <ul class="menu" role="menu">
      <li class="menu-item" id="menu-learn" role="presentation"><a href="https://www.epa.gov/environmental-topics" title="Learn about Environmental Topics that EPA covers." class="menu-link" role="menuitem">Environmental Topics</a></li>
      <li class="menu-item" id="menu-lawsregs" role="presentation"><a href="https://www.epa.gov/laws-regulations" title="Laws written by Congress provide the authority for EPA to write regulations. Regulations explain the technical, operational, and legal details necessary to implement laws." class="menu-link" role="menuitem">Laws &amp; Regulations</a></li>
      <li class="menu-item" id="menu-about" role="presentation"><a href="https://www.epa.gov/aboutepa" title="Learn more about: our mission and what we do, how we are organized, and our history." class="menu-link" role="menuitem">About EPA</a></li>
    </ul>
  </div>
</nav>
<footer class="main-footer clearfix" role="contentinfo">
  <div class="main-footer__inner">
    <div class="region-footer">
      <div class="block block-pane block-pane-epa-global-footer">
        <div class="row cols-3">
          <div class="col size-1of3">
            <div class="col__title">Discover.</div>
            <ul class="menu">
              <li><a href="https://www.epa.gov/accessibility">Accessibility</a></li>
              <li><a href="https://www.epa.gov/aboutepa/administrator-gina-mccarthy">EPA Administrator</a></li>
              <li><a href="https://www.epa.gov/planandbudget">Budget &amp; Performance</a></li>
              <li><a href="https://www.epa.gov/contracts">Contracting</a></li>
              <li><a href="https://www.epa.gov/home/grants-and-other-funding-opportunities">Grants</a></li>
              <li><a href="https://www.epa.gov/ocr/whistleblower-protections-epa-and-how-they-relate-non-disclosure-agreements-signed-epa-employees">No FEAR Act Data</a></li>
              <li><a href="https://www.epa.gov/home/privacy-and-security-notice">Privacy and Security</a></li>
            </ul>
          </div>
          <div class="col size-1of3">
            <div class="col__title">Connect.</div>
            <ul class="menu">
              <li><a href="https://www.data.gov/">Data.gov</a></li>
              <li><a href="https://www.epa.gov/office-inspector-general/about-epas-office-inspector-general">Inspector General</a></li>
              <li><a href="https://www.epa.gov/careers">Jobs</a></li>
              <li><a href="https://www.epa.gov/newsroom">Newsroom</a></li>
              <li><a href="https://www.whitehouse.gov/open">Open Government</a></li>
              <li><a href="http://www.regulations.gov/">Regulations.gov</a></li>
              <li><a href="https://www.epa.gov/newsroom/email-subscriptions">Subscribe</a></li>
              <li><a href="https://www.usa.gov/">USA.gov</a></li>
              <li><a href="https://www.whitehouse.gov/">White House</a></li>
            </ul>
          </div>
          <div class="col size-1of3">
            <div class="col__title">Ask.</div>
            <ul class="menu">
              <li><a href="https://www.epa.gov/home/forms/contact-us">Contact Us</a></li>
              <li><a href="https://www.epa.gov/home/epa-hotlines">Hotlines</a></li>
              <li><a href="https://www.epa.gov/foia">FOIA Requests</a></li>
              <li><a href="https://www.epa.gov/home/frequent-questions-specific-epa-programstopics">Frequent Questions</a></li>
            </ul>
            <div class="col__title">Follow.</div>
            <ul class="social-menu">
              <li><a class="menu-link social-facebook" href="https://www.facebook.com/EPA">Facebook</a></li>
              <li><a class="menu-link social-twitter" href="https://twitter.com/epa">Twitter</a></li>
              <li><a class="menu-link social-youtube" href="https://www.youtube.com/user/USEPAgov">YouTube</a></li>
              <li><a class="menu-link social-flickr" href="https://www.flickr.com/photos/usepagov">Flickr</a></li>
              <li><a class="menu-link social-instagram" href="https://instagram.com/epagov">Instagram</a></li>
            </ul>
            <p class="last-updated">This page was last updated on 2017-05-18</p>
          </div>
        </div>
      </div>
    </div>
  </div>
</footer>
<script src="https://www.epa.gov/sites/all/libraries/template2/jquery.js"></script>
<script src="https://www.epa.gov/sites/all/libraries/template2/js.js"></script>
<script src="https://www.epa.gov/sites/all/modules/custom/epa_core/js/alert.js"></script>
<script src="https://www.epa.gov/sites/all/libraries/js/datatables-1.10.12/datatables.min.js"></script>
<script src="https://www.epa.gov/sites/all/libraries/js/datatables-1.10.12/Responsive/js/dataTables.responsive.min.js"></script>
<script src="https://www.epa.gov/sites/all/libraries/js/datatables-1.10.12/Select/js/dataTables.select.min.js"></script>
<script src="https://www.epa.gov/sites/all/libraries/js/datatables-1.10.12/Buttons/js/dataTables.buttons.min.js"></script>
<script src="https://www.epa.gov/sites/all/libraries/js/datatables-1.10.12/Buttons/js/buttons.html5.min.js"></script>
<!--[if lt IE 9]><script src="https://www.epa.gov/sites/all/themes/epa/js/ie.js"></script><![endif]-->
<!-- <script src="js/porter-stemmer.js"></script> -->
<script src="js/base.js"></script>
<script src="js/ParsedDPLData.js"></script>
<script>
var advancedSearchFields = ["Name","Acronym","ShortDescriptionForReports","OwnershipType","OtherCostConsiderations","OpenSource","AlternativeNames","Keywords","Organization","ContactPerson","Email","Internet","LifeCycle","OperatingEnvironment","CompatibleOperatingSystems","OtherPropSoftwareReqs","ModelInputs","DataRequirements","ModelOutputTypes","OutputVariables","SourceOfSupportMaterials","TypesOfSupportMaterials","ModelEvaluation","ModelStructure","TimeScale","SpatialExtent","TechSkills","BaseCostOfSoftware","StewardDefinedTags","DecisionSector","Format"];
// details at READ web services' docs-page
var decisionSectors = ['land use','transportation','building infrastructure','waste management'];
var showToast = {'initialized':true};

var resultSet = new ToolSet(); // Create result and saved tool sets
var savedTools = new ToolSet();

var resultTable = new ToolDisplay('results-table', 'results-list', 'wizard'); // Create ToolDisplay Objects we need 

/* Create listeners and execute procedures which need done
 at the document's convenience in order to avoid a
 noticeable delay in displaying the page.
*/
$(function () { // jquery's shorthand awaits readiness of document
  updateInterface(Object.keys(subrolesByRole), $('#role'), "roleSelect()"); // populate roles into #role div
  initializeTabs(); // initialize tabs and their listeners
  
  /**
   * Updates the interface when a concept checkbox changes state.
   * @listens change
   */
  $('#concept').on('change', '.tool-label', function () {
    updateConceptsandResults();
  });

  /**
   * Toggles the saved state of a tool via a list div checkbox.
   * @listens change
   */
  $(".list").on("change", "input:checkbox", function () {
    var id = $(this).val();
    var rows = $('#results-table').DataTable().rows();
    var rowNodes = rows.nodes();
    if ($(this).prop('checked')) { // add selected class
      $("#results-table").DataTable().rows(function (idx, data, node) {
        return data[1] == id ? true: false;
      }).nodes().to$().addClass("selected");
      $('#' + id).prop('checked', true);
      savedTools.addTool(id);
      $('input[type="checkbox"]', rowNodes).each(function () {
        if ($(this).val() === id) {
          $(this).prop('checked', true);
        }
      });
    } else {
      $("#results-table").DataTable().rows(function (idx, data, node) {
        return data[1] == id ? true: false;
      }).nodes().to$().removeClass("selected");
      $('#' + id).prop('checked', false);
      savedTools.removeTool(id);
      $('input[type="checkbox"]', rowNodes).each(function () {
        if ($(this).val() === id) {
          $(this).prop('checked', false);
        }
      });
    }
    updateConcepts();
  });

  /**
   * Toggles the saved state of a tool via a DataTable row.
   * @listens click
   */
  $('tbody').on('click', 'input[type="checkbox"]', function () {
    var $parent = $(this).parent().parent();
    var tableId = $(this).closest('table').attr('id').slice(0, -6);
    var readId = $(this).val(); // get ID
    if ($parent.hasClass('selected')) { // remove selected class
      $('#' + tableId + '-list-cb-' + readId).prop('checked', false);
      savedTools.removeTool(readId);
      $parent.removeClass('selected');
    }
    else {
      $('#' + tableId + '-list-cb-' + readId).prop('checked', true);
      savedTools.addTool(readId);
      $parent.addClass('selected');
    }
  });

  // create flags for controlling whether to show instructional notifications
  var instructionalCheckboxes = ['role', 'subrole', 'fundamental-objective', 'objective', 'concept',  'results-list', 'results-table'];
  for (checkboxGroupIndex in instructionalCheckboxes) {
    var checkboxGroup = instructionalCheckboxes[checkboxGroupIndex];
    showToast[checkboxGroup] = true;
  }

});

/**
 * Initialize tabs; create listener for switching tabs
 * @function
 */
var initializeTabs = function () {
  $('#tabs > div').hide(); // hide all tab-panels
  $('#tabs div:first').show(); // show first tab-panel
  $('.menu-internal').click(function () { // add listener to tabbing elements
    if (!$(this).is('[aria-disabled]')) { // tab doesn't have an aria-disabled attribute...
      $('#tabsnav li a').removeClass('active'); // remove active styling from all tabs
      $(this).addClass('active'); // activate the clicked tab
      var currentPanel = '#' + $(this).attr('aria-controls');// make a jquery object selecting the panel associated with the clicked tab
      $('#tabs > div').hide(); // hide all panels
      $(currentPanel).show(); // show clicked tab's panel
      $('#results-container').show(); // Display Results
      $('#results-container').attr('aria-hidden', 'false');
    }else { // tab has attribute aria-disabled...
      return;
    }
  });
};

/**
 * Show more or fewer objectives
 * @function
 * @param {number} - A number that symbolizes if we add or subtract objectives from displaying. 
 */
var objectiveDisplay = function (adjust) {
  $('#objective-relevance').val(parseInt($('#objective-relevance').val()) + parseInt(adjust));
  var val = $('#objective-relevance').val();
  if (val <= 0) {
    $('#objective-relevance-decrease').prop('disabled', true);
  }else if (val >= 2) {
    $('#objective-relevance-increase').prop('disabled', true);
  }else{
    $('#objective-relevance-decrease').prop('disabled', false);
    $('#objective-relevance-increase').prop('disabled', false);
  }
  fundamentalObjectiveSelect();
};

/** 
 * Handle selection and deselection to inform users of necessary information.
 * @function
 * @param {string} checkboxGroup - The ID of the container.
 */
var checkboxChangeHandler = function(checkboxGroup) {
  if (showToast[checkboxGroup] !== false && showToast['all'] !== false) {// condition: are these toasts unmuted?
    if (checkboxGroup.indexOf('table') === -1) {
      buttonText = (checkboxGroup === 'concept') ? ($('#concept-search-button').text()) : ('next')//BOOKMARK: insert dynamically grabbed text for 'Display Tools' if checkboxGroup == 'concept'; else insert "next"
      var message = 'Select all desired ' + checkboxGroup + 's then press the button labeled "' + buttonText + '." Selections can be changed at any time by returning to the desired tab.';
        toast({html:message,close:true,disable:true});
        showToast[checkboxGroup] = false;
    } else {
      var message = 'Select all desired ' + checkboxGroup + 's then press the button labeled "next." Selections can be changed at any time.';
      showToast[checkboxGroup] = false;
      toast({html:message,close:true,disable:true});
    }
  }
}

/**
 * Updates the interface when a change occurs.
 * @function
 * @param {array} list - The list which we'll use to populate the checkboxes.
 * @param {object} $container - The container which we will place the checkboxes in.
 * @param {string} onChange - The function which will be run when the checkbox state is changed.
 */
var updateInterface = function (list, $container, onChange) {
  populate(list, $container, onChange);// populate list into $container
  toggleTab(list, $container);// enable next tab iff list not empty
  var nextButtonClassSubstring = $container.attr("id");// identify next button by who enables it
  toggleNext(list, nextButtonClassSubstring);// enable next button iff list not empty 
};

/**
 * Populate list into specified $container; maintain selections when possible
 * @function
 * @param {array} list - The list which we'll use to populate the checkboxes.
 * @param {object} $container - The container which we will place the checkboxes in.
 * @param {string} onChange - The function which will be run when the checkbox state is changed.
 */
var populate = function (list, $container, onChange) {
  if (typeof list === 'undefined') { // ensure list is defined
    list = [];
  }
  var currentlySelected = []; // create container for current selections
  $container.find(':checked').each(function (i, v) {
    currentlySelected.push(v.value); // store current selections in container
  });
  var html = addCheckboxes(list.sort(), $container, onChange); // repopulate new selectables
  $container.html(html); // create contents of $container
  $container.find('input[type=checkbox]').each(function (i, v) { // look through each element in $container
    if (currentlySelected.indexOf(v.value) !== -1) { // check if item was selected
      $($(v)[0]).prop('checked', true); // select item
    }
  });
};

/**
 * Populate list with header values; maintain selections when possible
 * @function
 * @param {array} list - The list which we'll use to populate the checkboxes.
 * @param {object} $container - The container which we will place the checkboxes in.
 * @param {string} onChange - The function which will be run when the checkbox state is changed.
 */
var populateWithHeader = function (list, $container, onChange) {
  if (typeof list === 'undefined') {
    list = {length:0}; // ensure list is defined
  }
  var currentlySelected = [];
  $container.find(':checked').each(function (i, v) { // create an array for currently selected values
      currentlySelected.push(v.value);
  });
  var html = '';
  var count = 0;
  for (var i in list) {
    if (list.hasOwnProperty(i)) {
      html += '<h5 class="highlighted">' + i + '</h5><div id="' + $container.attr('id') + '-' + count + '">';
      html += addCheckboxes(list[i].sort(), $container, onChange, count);
      html += '</div>';
      count++;
    }
  }
  $container.html(html);
  toggleTab(list, $container); // enable next tab iff list not empty
  var nextButtonClassSubstring = $container.attr("id"); // identify next button by who enables it
  toggleNext(list, nextButtonClassSubstring); // enable next button iff list not empty 
  $container.find('input[type=checkbox]').each( function (i, v) { // look through each element in $container
    if (currentlySelected.indexOf(v.value) !== -1) { // check if item was currentlySelected
      $($(v)[0]).prop('checked', true); // select item
    }
  });
};

/**
 * Toggle disabled state of a next button
 * @function
 * @param {array} - The list of items we are loading into the next page.
 * @param {string} - The ID of the container the list comes from.
 */
var toggleNext = function (list, nextButtonClassSubstring) {
  var nextButtonSelector = '.enabled-by-' + nextButtonClassSubstring; // identify next button by who enables it
  if (list.length > 0 || Object.keys(list).length > 0) {
    $(nextButtonSelector + ':not(.persist)').prop('disabled', false).css('display', 'inline');
  } else {
    $(nextButtonSelector+':not(.persist)').prop('disabled',true).css('display','none');
  }
};

/**
 * Show the tab if there is anything to display in that tab.
 * @function
 * @param {array} list - An array containing the list of elements to display on the particular tab.
 * @param {object} $container - The jQuery selection for the container we are loading the list into.
 */
var toggleTab = function (list, $container) {
  tabAnchor = '#' + $container.parent().attr('aria-labelledby');
  if (list.length > 0 || Object.keys(list).length > 0) { // items in list enable tabs
    $(tabAnchor).removeAttr('aria-disabled');
    $(tabAnchor).attr('href', $(tabAnchor).attr('data-href'));
    $(tabAnchor).parent().removeAttr('aria-hidden');
    $(tabAnchor).removeAttr('aria-hidden');
    $(tabAnchor).show();
  } else { // no items in list disable tabs
    $(tabAnchor).attr('aria-disabled', 'true').removeAttr('href');
    $(tabAnchor).hide();
    $(tabAnchor).parent().attr('aria-hidden', 'true');
  }
};

/**
 * Populate the #subrole container with subrole options for the selected roles.
 * @function
 */
var roleSelect = function () {
  var selectedElements = scrapeDictionaryToObject($("input[name='role-checkbox']:checked"), subrolesByRole);
  populateWithHeader(selectedElements, $('#subrole'), "subroleSelect()");
  subroleSelect();
};

/**
 * Populate the #objective container with objective options for the selected subroles.
 * @function
 */
var subroleSelect = function () {
  var relevance = $('#objective-relevance').val();
  var objectivesFromSubroles = [];
  var objectivesFromSubrolesRelevance = [];
  for (var i = 0; i <= relevance; i++) {
    objectivesFromSubrolesRelevance = scrapeDictionary($("input[name='subrole-checkbox']:checked"), objectivesBySubroleRelevance[i]);
    for (var j = 0; j < objectivesFromSubrolesRelevance.length; j++) {
      if (objectivesFromSubroles.indexOf(objectivesFromSubrolesRelevance[j]) === -1) {
        objectivesFromSubroles.push(objectivesFromSubrolesRelevance[j]);
      }
    }
  }
  var list = [];
  if (objectivesFromSubroles.length > 0) {
    for (var prop in objectivesByFundamentalObjective) {
      if (objectivesByFundamentalObjective.hasOwnProperty(prop)) {
        for (var k = 0; k < objectivesFromSubroles.length; k++) {
          if (objectivesByFundamentalObjective[prop].indexOf(objectivesFromSubroles[k]) !== -1) {
            if (list.indexOf(prop) === -1) {
              list.push(prop);
            }
            break;
          }          
        }
      }
    }
  }
  updateInterface(list, $('#fundamental-objective'), "fundamentalObjectiveSelect()");
  fundamentalObjectiveSelect();
};

/**
 * Populate the #objective container with objectives determined by selected subroles and fundamental objectives.
 * @function
 */
var fundamentalObjectiveSelect = function () {
  var relevance = $('#objective-relevance').val();
  var objectivesFromSubroles = [];
  var objectivesFromSubrolesRelevance = [];
  for (var i = 0; i <= relevance; i++) {
    objectivesFromSubrolesRelevance = scrapeDictionary($("input[name='subrole-checkbox']:checked"), objectivesBySubroleRelevance[i]);
    for (var j = 0; j < objectivesFromSubrolesRelevance.length; j++) {
      if (objectivesFromSubroles.indexOf(objectivesFromSubrolesRelevance[j]) === -1) {
        objectivesFromSubroles.push(objectivesFromSubrolesRelevance[j]);
      }
    }
  }
  /* get objectives specified by selected fundamental objectives */
  var objectivesFromFundamentalObjectives = scrapeDictionary($("input[name='fundamental-objective-checkbox']:checked"), objectivesByFundamentalObjective);
  /* get objectives specified by both subroles and fundamental objectives */
  var objectives = [];
  for (i = 0; i < objectivesFromSubroles.length; i++) {
    if (objectivesFromFundamentalObjectives.indexOf(objectivesFromSubroles[i]) !== -1) {
      objectives.push(objectivesFromSubroles[i]);
    }
  }
  updateInterface(objectives, $('#objective'), "objectiveSelect()");
  objectiveSelect();
};

/**
 * Populate the #concept container with the concept options for selected objectives.
 * @function
 */
var objectiveSelect = function () {
  var selectedElements = scrapeDictionary($("input[name='objective-checkbox']:checked"), conceptsByObjective);
  $('#concept').html('');
  updateInterface(selectedElements, $('#concept'));
  updateConcepts();
};

/**
 * Create an array of values taken from dictionary for the selected options.
 * @function
 * @param {object} selectedOptions - A jQuery selection of the checked checkboxes
 * @param {object} dictionary - The dictionary we are taking values from.
 * @return {array} - An array containing the elements from the dictionary which match the values in selectedOptions
 */
var scrapeDictionary = function (selectedOptions, dictionary) {
  var selectedElement = '';
  var selectedElements = [];
  var allSelectedElements = [];
  for (var i = 0; i < selectedOptions.length; i++) {
    selectedElement = selectedOptions[i].value;
    selectedElements = dictionary[selectedElement];
    if (typeof selectedElements === 'undefined') {
      selectedElements = [];
    }
    for (var j = 0; j < selectedElements.length; j++) {
      if (allSelectedElements.indexOf(selectedElements[j]) === -1) {
        allSelectedElements.push(selectedElements[j]);
      }
    }
  }
  return allSelectedElements;
};

/**
 * Get child values (properties) for a selected option from a specified object while the key values retained for use in headers
 * @function
 * @param {object} selectedOptions - A jQuery selection of the checked checkboxes
 * @param {object} dictionary - The dictionary we are taking values from.
 * @return {object} - An object containing the elements from the dictionary which match the values in selectedOptions
 */
var scrapeDictionaryToObject = function (selectedOptions, dictionary) {
var selectedElement = '';
var selectedElements = [];
var allSelectedElements = [];
var selectedElementsObject = {};
for (var i = 0; i < selectedOptions.length; i++) {
  selectedElement = selectedOptions[i].value;
  selectedElements = dictionary[selectedElement];
  selectedElementsObject[selectedElement] = dictionary[selectedElement];
  if (typeof selectedElements === 'undefined') {
    selectedElements = [];
  }
  for (var j = 0; j < selectedElements.length; j++) {
    if (allSelectedElements.indexOf(selectedElements[j]) === -1) {
      allSelectedElements.push(selectedElements[j]);
    }
  }
}
return selectedElementsObject;
};

/**
 * Add checkboxes with specified values to the specified container.
 * @function
 * @param {array} list - An array containing the values to populare the checkboxes with.
 * @param {object} container - The jQuery selection which will hold the checkboxes.
 * @param {string} onChange - The function which will run when a checkbox is changed.
 * @param {number} count - Optional parameter which is used when populating with headers.
 * @return {string} - The HTML to create checkboxes.
 */
function addCheckboxes(list, container, onChange, count) {
  var containerName = container.attr('id');
  onChange = 'onchange="checkboxChangeHandler(\'' + containerName + '\');' + onChange + '"';
  count = (typeof count !== 'undefined') ? count : "0";
  var inputs = container.children('input');
  var id = inputs.length + 1;
  var html = '';
  for (var i = 0; i < list.length; i++) {
    var concept = list[i];
    var numberOfToolsSpan = '';
    var numberOfTools = 0;
    if (containerName === 'concept') {
      var length = readIDsByConcept[concept].length;
      for (var j = 0; j < length; j++) {
        if (!resultSet.contains(readIDsByConcept[concept][j])) {
          numberOfTools++;
        }
      }
      if (numberOfTools === 1) {
        numberOfToolsSpan = ' <span class="tool-count" style="background: #e1f3f8;color: #212121;padding: 0 .5em;margin-bottom: .5em;">Add ' + numberOfTools + ' Tool' + '</span>'; 
      } else {
        numberOfToolsSpan = ' <span class="tool-count" style="background: #e1f3f8;color: #212121;padding: 0 .5em;margin-bottom: .5em;">Add ' + numberOfTools + ' Tools' + '</span>'; 
      }
    }
    html += '<input class="tool-label" type="checkbox" id="cb-' + containerName + '-' + count + '-' + id + '" value="' + concept + '" name="' + containerName + '-checkbox" ' + onChange + ' /><label for="cb-' + containerName + '-' + count + '-' + id + '" class="unselectable">' + concept + numberOfToolsSpan + '</label>';
    id++;
  }
  return html;
}

/**
 * Search in descriptions for each word in query string from input and display results in div
 * @function
 * @deprecated
 */
var keywordSearch = function (div, input) {
  $('#' + div + ' *').remove();
  var keywords = getKeywords(input);
  for (var i = 0; i < keywords.length; i++) {
    for (var j = 0; j < decisionSectors.length; j++) {
      $.get('https://ofmpub.epa.gov/readwebservices/v1/ResourceAdvancedSearch',
        {
          ShortDescriptionForReports: keywords[i],
          DecisionSector: decisionSectors[j]
        }
      ).done(function (data) {
        for (var i = 0; i < data.length; i++) {
          getResourceDetail(data[i].ResourceId, div);
        }
      });
    }
  }
};

/**
 * Search for the READ IDs from the selected Concepts from input and display results in div
 * @function
 */
var conceptSearch = function () {
  $('#results-notification').html('').removeClass().attr('aria-hidden', 'true');
  resultSet.reset(); // remove from resultSet
  if ($.fn.DataTable.isDataTable('#results-table')) {
    $('#results-table').DataTable().rows('tr:not(.selected)').remove().draw(); // clear table of values not marked selected
  }
  $('#results-list .results-checkbox').each(function () { // clear results list of values not checked
    if (!$(this).prop('checked')) {
      $(this).parent().parent().parent().remove();
      resultTable.getToolSet().removeTool($(this).val()); // clear display data
    }
  });

  if (savedTools.getLength() === 0) {
    $('#results-tab').parent().attr('aria-hidden', 'true');
  }

  var concepts = getConcepts($('input[name="concept-checkbox"]:checked')); //get new concepts
  if (concepts.length < 1 && !savedTools.getLength()) {
    $('#results-container').hide();
    $('#results-container').attr('aria-hidden', 'true');
    $('#concept-search-button').text('Show Results');
    return;
  } else {
    for (var i = 0; i < concepts.length; i++) {
      if (readIDsByConcept[concepts[i]]) {
        for (var j = 0; j < readIDsByConcept[concepts[i]].length; j++) {
          if (!savedTools.contains(readIDsByConcept[concepts[i]][j])) {
            resultSet.addTool(readIDsByConcept[concepts[i]][j]);
          }
        }
      }
    }
  }
  var numberOfTools = resultSet.getLength();
  if (savedTools.getLength()) {
    for (var toolId in savedTools.getToolSet()) {
      if (!resultSet.getToolSet().hasOwnProperty(toolId)) {
        numberOfTools++;
      }
    }
  }
  if (numberOfTools === 1) {
    $('#concept-search-button').text('Show ' + numberOfTools + ' Result');
  } else {
    $('#concept-search-button').text('Show ' + numberOfTools + ' Results');
  }
};

/**
 * Displays the number of tools which will be added/removed from selecting/deselecting a particular concept
 * @function
 */
function updateConcepts() {
  $('#concept .tool-count').each(function () { // for each tool label
    var $conceptCheckbox = $('#' + $(this).parent().attr('for')); // get associated checkbox
    var concept = $conceptCheckbox.val(); // get associated concept
    var length = readIDsByConcept[concept].length; // number of tools related to this concept
    var numberOfTools = 0; 
    if (!$('#' + $(this).parent().attr('for')).prop('checked')) { // if this is not checked
      for (var j = 0; j < length; j++) {
        var toolId = readIDsByConcept[concept][j];
        if (!resultSet.contains(toolId) && !savedTools.contains(toolId)) { // count the number of tools that are not in the result set
          numberOfTools++;
        }
      }
      if (numberOfTools === 1) {
        $(this).text("Add " + numberOfTools + ' Tool');
      } else {
        $(this).text("Add " + numberOfTools + ' Tools');
      }
    } else {
      for (var k = 0; k < length; k++) {
        var toolId = readIDsByConcept[concept][k];
        if (resultSet.toolIsUnique(toolId) && !savedTools.contains(toolId)) { // count the number of unique tools tied to this concept
          numberOfTools++;
        }
      }
      if (numberOfTools === 1) {
        $(this).text("Remove " + numberOfTools + ' Tool');
      } else {
        $(this).text("Remove " + numberOfTools + ' Tools');
      }
    }
  });
}

/**
 * Runs a concept search and updates the list of concepts 
 * @function
 */
function updateConceptsandResults() {
  conceptSearch('results-list', $('input[name="concept-checkbox"]:checked'));
  updateConcepts();
}

/**
 * Display the current result set.
 * @function
 */
var displayResults = function () {
  if (resultSet.getLength() > 0 || savedTools.getLength() > 0) {  
    $('#results-tab').parent().attr('aria-hidden', 'false');
    $('#results-tab')[0].click();
    $('#list-radio').prop('checked', true);
    activateNextTab($('#results-tab'));
    if (!resultSet.isEqual(resultTable.getToolSet())) {
      $('#loader').removeAttr('aria-hidden').show();
      createDataTable('results');
      toolCache.handleToolSet(resultSet, resultTable.displayTools.bind(resultTable));
    }
  } else {
    toast({html: 'Please select a concept.', close: true});
  }
}

/**
 * Execute the conceptSearch and displayResults functions.
 * @function
 * @deprecated
 */
var findAndDisplayResults = function() {
  conceptSearch('results-list', $('input[name=\x22concept-checkbox\x22]:checked'));
    displayResults();
}

/**
 * Extract text values of the passed in jQuery object and store in an array.
 * @function
 * @param {object} input - jQuery selection of the checked concept checkboxes.
 * @return {array} - An array containing the selected concepts values.
 */
var getConcepts = function (input) {
  var concept = '';
  var concepts = [];
  $(input).each(function () {
    concept = $(this).val();
    if (concept.length > 1) {
      concepts.push(concept);
    }
  });
  return concepts;
};

/**
 * Process the selected concepts into their constituent words to serve as keywords.
 * @function
 * @deprecated
 * @param {object} input - The jQuery selection containing the selected concepts.
 * @return {array} - An array of words.
 */
var getKeywords = function (input) {
  var concept = '';
  var concepts = [];
  var keyword = '';
  var keywords = [];
  $(input).each(function () {
    concept = $(this).val();
    if (concept.length > 1) {
      keywords = concept.split(' ');
      for (var i = 0; i < keywords.length; i++) {
        keyword = keywords[i];
        if ((concepts.indexOf(keyword) === -1) && (keyword.length > 3)) {
          concepts.push(keyword);
        }
      }
    }
  });
  return concepts;
};

/**
 * Finds all concepts that are associated with the selected concepts by finding all concepts which are connected to the same objectives.
 * @function
 */
var broadenConcepts = function () {
  if ($('input[name="concept-checkbox"]:checked').length === 0) {
    toast({html: 'Please select a concept.', close: true});
    return;
  }
  var allConcepts = [];
  var checkedConcepts = [];
  var associatedConcepts = [];
  $("input[name='concept-checkbox']").each(function () {
    if ($(this).prop("checked")) {
      checkedConcepts.push($(this).val());
    }
    allConcepts.push($(this).val());
  });

  for (var k = 0; k < checkedConcepts.length; k++) { // iterate through checkedConcepts
    for (var objective in conceptsByObjective) { // find objectives that have this concepts, and thus associated concepts
      if (conceptsByObjective.hasOwnProperty(objective)) {
        if (conceptsByObjective[objective].indexOf(checkedConcepts[k]) !== -1) {
          for (var j = 0; j < conceptsByObjective[objective].length; j++) {
            if (associatedConcepts.indexOf(conceptsByObjective[objective][j]) === -1 && conceptsByObjective[objective][j].length > 1 && allConcepts.indexOf(conceptsByObjective[objective][j]) === -1) {
              associatedConcepts.push(conceptsByObjective[objective][j]);
            }
          }
        }
      }
    }
  }
  if (associatedConcepts.length === 0) {
    toast({html: 'No related concepts found.', close: true});
  }
  var html = addCheckboxes(associatedConcepts, $('#concept'));
  $('#concept').append(html);
};

/**
 * Selects the next tab when next button is activated
 * @function
 * @param {object} $nextTab - The next tab
 * @param {string} URLToShow - thisDocument.html#someHashValueToJumpTo
 */
var activateNextTab = function ($nextTab, URLToShow) {
  var firstString;
  if ($nextTab.parent().attr('aria-hidden') === 'true') {
    if ('aeiouhAEIOUH'.indexOf($nextTab.attr('data-name')[0]) !== -1) {
      firstString = 'Select an ';
    } else {
      firstString = 'Select a ';
    }
    toast({html: firstString + $nextTab.attr('data-name') + ' to proceed.', close: true});
  } else {
    if (typeof(URLToShow) !== 'undefined' && window.innerWidth < 480) {
        window.location = URLToShow;
    }
    $nextTab.siblings('[role=tab][aria-selected=true]').attr('aria-selected', 'false');// deactivate active tab
    $nextTab.attr('aria-selected', 'true');// list this tab as active
    $nextTab.prop('disabled', false);// enable tab
    $nextTab.click();// activate tab
  }
};
</script>
</body>
</html>
